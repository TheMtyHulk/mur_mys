{% extends 'layout.html' %}
{% load widget_tweaks %}

{% block content %}
<div class="content">
    <div class="container">
        <h1>Change Password</h1>
        
        <div class="box">
            <form method="post">
                {% csrf_token %}
                
                <div class="form-group">
                    <label for="{{ form.old_password.id_for_label }}">Current Password</label>
                    {% render_field form.old_password class="custom-input" placeholder="Current Password" %}
                    {% if form.old_password.errors %}
                        <small class="error">{{ form.old_password.errors }}</small>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <label for="{{ form.new_password1.id_for_label }}">New Password</label>
                    {% render_field form.new_password1 class="custom-input" placeholder="New Password" %}
                    {% if form.new_password1.errors %}
                        <small class="error">{{ form.new_password1.errors }}</small>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <label for="{{ form.new_password2.id_for_label }}">Confirm New Password</label>
                    {% render_field form.new_password2 class="custom-input" placeholder="Confirm New Password" %}
                    {% if form.new_password2.errors %}
                        <small class="error">{{ form.new_password2.errors }}</small>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-accent btn-block">Change Password</button>
                    <a href="{% url 'profile' %}" class="btn btn-accent btn-block" style="background: #ea36af;">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Handle password change success
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('changed') === 'true') {
        alert('Password changed successfully!');
        window.location.href = '/profile/';
    }
</script>
{% endblock %}
